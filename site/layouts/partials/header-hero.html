{{ "<!-- hero header -->" | safeHTML }}
{{ $p := .parallax | default true}}
{{ $isParent := .Content.IsAncestor .Content.Page}}
<div class="master-header">
    <div class="hero-header {{if $p }} rellax {{end}}  container {{if .media.video_active}} video-active {{end}}">
        <div class="hero-header-inner">
            <div class="contentWrapper">
                <div class="grid-container">
                    <div class="grid-y grid-frame {{if  $p }}rellax{{end}}" data-rellax-speed="-3">
                        <div class="cell auto cell-block-container">
                            <div class="grid-x align-center-middle p-t-50">
                                <div class="cell small-12 medium-10 large-8">
                                    <div class="grid-x align-center-middle text-center">
                                        <div class="cell small-12">
                                            {{if $isParent}}
                                            <h4>{{ .Content.Title | safeHTML}}</h4>
                                            {{end}}
                                        </div>
                                        {{with .Content.Params.video}}
                                        <div class="cell small-12 trailer">
                                            <button class="button-trailer">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="70" height="70" viewBox="0 0 70 70">
                                                    <g fill="none" fill-rule="evenodd">
                                                        <circle cx="35" cy="35" r="33" stroke="#FFF" stroke-width="4"/>
                                                        <path fill="#E74F4F" d="M47.431 36.675L30.093 47.983A2 2 0 0 1 27 46.308V23.692a2 2 0 0 1 3.093-1.675L47.43 33.325a2 2 0 0 1 0 3.35z"/>
                                                    </g>
                                                </svg>
                                                <span>Watch the trailer</span>
                                            </button>
                                        </div>
                                        {{end}}
                                        <div class="cell small-12">
                                            {{if $isParent}}
                                                <h1>{{ .Content.Params.subtitle | safeHTML}}</h1>
                                            {{else}}
                                            {{if isset .Content.Params "logo"}}
                                                <img src="{{.Content.Params.logo}}" alt="{{- .Content.Title -}}">
                                            {{else}}
                                                <h1>{{ .Content.Title | safeHTML}}</h1>
                                            {{end}}
                                            {{end}}
                                        </div>
                                        {{if isset .Content.Params "order_status"}}
                                            {{if eq .Content.Params.order_status "Out now"}}
                                                {{with .Content.Params.buy}}
                                                <div class="cell small-12">
                                                    <button id="buy_now" class="white hollow button">Buy now</button>
                                                </div>
                                                {{end}}
                                            {{end}}
                                        {{end}}
                                        <div class="cell small-12">
                                            {{if $isParent}}
                                                {{- .Content.Content -}}
                                            {{if eq .Content.Section "careers"}}
                                                <a href="#careers"  data-smooth-scroll class="white hollow button m-t-50">Work with us
                                                    {{ partial "functions/get_count"  ( dict "Context" site)}}
                                                </a>
                                            {{end}}
                                            {{else}}
                                                {{- .Content.Params.summary -}}
                                            {{end}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {{if not .ctx.IsHome }}
                            <div class="cell shrink">
                                {{ partial "breadcrumbs" .Content}}
                            </div>
                        {{end}}
                    </div>
                </div>
            </div>
        </div>
    <div class="imageWrapper">
        <img src="{{ .Content.Params.featured_image.src }}" alt="{{ .Content.Params.featured_image.alt }}">
        {{if not .Content.Params.video_active}}
            <div class="desktop {{ if .bg_image_mobile }}hide-for-small{{ end }} {{if $p }} rellax {{end}} "  style="background-image: url('{{ .Content.Params.featured_image.src }}')" data-rellax-speed="-7"></div>
            {{ if .bg_image_mobile }}<div class="mobile"   style="background-image: url('{{ .bg_image_mobile }}')"></div> {{ end }}
        {{ else }}
            <div  class="video-wrapper video-background" data-video="{{ .media.video }}" style="background-image: url('{{ .Content.Params.featured_image.src}}')">
                <div id="video-player" class="video-foreground responsive-embed"><div id="ytplayer" ></div></div>
            </div>
        <script>
        var tag = document.createElement('script');
        var videoPlayer = document.getElementById('video-player');
        tag.src = "https://www.youtube.com/player_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        var video = {{ .media.video }};
        var player;

        function onYouTubePlayerAPIReady() {
            player = new YT.Player('ytplayer', {
                videoId: video,
                width: '100%',
                height: '100%',
                playerVars: {
                    autohide:1,
                    autoplay:1,
                    mute:1,
                    loop:1,
                    controls:0,
                    modestbranding:1,
                    playsinline:1,
                    rel:0,
                    showinfo:0,
                    wmode:'opaque',
                    widgetid:1
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }
        function onPlayerReady(event) {

            player.playVideo()
            player.mute(); // comment out if you don't want the auto played video muted

            setTimeout(function(){videoPlayer.className += ' playing'}, 500);
        }
        function onPlayerStateChange(event) {
            if (event.data == YT.PlayerState.ENDED) {
                player.seekTo(0);
                player.playVideo();
            }
        }
        </script>
        {{ end }}
    </div>
    </div>
</div>



